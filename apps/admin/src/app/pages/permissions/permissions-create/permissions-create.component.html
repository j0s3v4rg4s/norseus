<div class="container">
  <div class="flex items-center mb-6">
    <h1 class="text-2xl font-bold">Crear nuevo permiso</h1>
  </div>

  <div class="max-w-3xl mx-auto">
    <div class="bg-white rounded-lg shadow-lg p-4 mb-8">
      <form [formGroup]="form" class="mb-8">
        <div class="grid gap-3">
          <label for="role-name" class="label">Nombre del rol</label>
          <input
            class="input"
            id="role-name"
            formControlName="roleName"
            type="text"
            placeholder="Ingrese el nombre del rol"
            [attr.aria-invalid]="form.get('roleName')?.invalid && form.get('roleName')?.touched"
          />
        </div>
      </form>

      <h2 class="text-lg font-semibold text-slate-700 mb-4">Permisos</h2>
      <div class="overflow-x-auto rounded-lg">
        <table class="permissions-matrix w-full">
          <thead>
            <tr>
              <th class="p-3 w-1/4 text-left text-sm font-semibold text-slate-700"></th>
              @for (action of actions; track action) {
                <th class="p-3 text-center text-sm font-semibold text-slate-700">
                  {{ getActionLabel(action) }}
                </th>
              }
            </tr>
          </thead>
          <tbody>
            @for (section of sections; track section) {
              <tr class="border-t border-slate-200">
                <td class="p-3 font-medium text-slate-800">
                  {{ getSectionLabel(section) }}
                </td>
                @for (action of actions; track action) {
                  <td class="p-3 text-center">
                    <input
                      type="checkbox"
                      [checked]="hasPermission(section, action)"
                      (change)="onPermissionChange($event, section, action)"
                      class="h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary-focus cursor-pointer"
                    />
                  </td>
                }
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
    @if (store.statusSaveMessage()) {
      <div class="text-red-400 text-sm mb-2">{{ store.statusSaveMessage() }}</div>
    }
    <div class="flex justify-between items-center">
      <button class="btn-outline" routerLink="/home/permissions">Cancelar</button>
      <button
        class="btn"
        (click)="saveRole()"
        ui-button
        [isLoading]="store.isLoading()"
      >
        Guardar
      </button>
    </div>
  </div>
</div>
